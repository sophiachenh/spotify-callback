<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spotify Callback</title>
</head>
<body>
  <h1>Spotify Authentication Successful</h1>
  <script>
    // Get the code from the URL
    const code = new URLSearchParams(window.location.search).get("code");

    if (code) {
      const clientId = "aab1ffc368c24a60a291c6705b89f7b1";  // Replace with your client ID
      const clientSecret = "0eca651a8a58408eae91f39349797b77";  // Replace with your client secret
      const redirectUri = "https://sophiachenh.github.io/spotify-callback/callback.html";  // Replace with your redirect URI

      const headers = new Headers();
      headers.set('Authorization', 'Basic ' + btoa(clientId + ':' + clientSecret));
      headers.set('Content-Type', 'application/x-www-form-urlencoded');

      const body = new URLSearchParams({
        grant_type: 'authorization_code',
        code: code,
        redirect_uri: redirectUri
      });

      // Make the request to exchange the code for an access token
      fetch('https://accounts.spotify.com/api/token', {
        method: 'POST',
        headers: headers,
        body: body
      })
        .then(response => response.json())
        .then(data => {
          if (data.access_token) {
            console.log('Access Token:', data.access_token);
            // Send the token to the background script
            chrome.runtime.sendMessage({ action: 'storeToken', token: data.access_token });
          } else {
            console.error('Failed to retrieve access token');
          }
        })
        .catch(err => {
          console.error('Error:', err);
        });
    }
  </script>
</body>
</html>









